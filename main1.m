vowelTraining = [
    "./nguyenAmHuanLuyen/01MDA/a.wav", "./nguyenAmHuanLuyen/01MDA/e.wav", "./nguyenAmHuanLuyen/01MDA/i.wav", "./nguyenAmHuanLuyen/01MDA/o.wav", "./nguyenAmHuanLuyen/01MDA/u.wav", "./nguyenAmHuanLuyen/02FVA/a.wav", "./nguyenAmHuanLuyen/02FVA/e.wav", "./nguyenAmHuanLuyen/02FVA/i.wav", "./nguyenAmHuanLuyen/02FVA/o.wav", "./nguyenAmHuanLuyen/02FVA/u.wav", "./nguyenAmHuanLuyen/03MAB/a.wav", "./nguyenAmHuanLuyen/03MAB/e.wav", "./nguyenAmHuanLuyen/03MAB/i.wav", "./nguyenAmHuanLuyen/03MAB/o.wav", "./nguyenAmHuanLuyen/03MAB/u.wav", "./nguyenAmHuanLuyen/04MHB/a.wav", "./nguyenAmHuanLuyen/04MHB/e.wav", "./nguyenAmHuanLuyen/04MHB/i.wav", "./nguyenAmHuanLuyen/04MHB/o.wav", "./nguyenAmHuanLuyen/04MHB/u.wav", "./nguyenAmHuanLuyen/05MVB/a.wav", "./nguyenAmHuanLuyen/05MVB/e.wav", "./nguyenAmHuanLuyen/05MVB/i.wav", "./nguyenAmHuanLuyen/05MVB/o.wav", "./nguyenAmHuanLuyen/05MVB/u.wav", "./nguyenAmHuanLuyen/06FTB/a.wav", "./nguyenAmHuanLuyen/06FTB/e.wav", "./nguyenAmHuanLuyen/06FTB/i.wav", "./nguyenAmHuanLuyen/06FTB/o.wav", "./nguyenAmHuanLuyen/06FTB/u.wav", "./nguyenAmHuanLuyen/07FTC/a.wav", "./nguyenAmHuanLuyen/07FTC/e.wav", "./nguyenAmHuanLuyen/07FTC/i.wav", "./nguyenAmHuanLuyen/07FTC/o.wav", "./nguyenAmHuanLuyen/07FTC/u.wav", "./nguyenAmHuanLuyen/08MLD/a.wav", "./nguyenAmHuanLuyen/08MLD/e.wav", "./nguyenAmHuanLuyen/08MLD/i.wav", "./nguyenAmHuanLuyen/08MLD/o.wav", "./nguyenAmHuanLuyen/08MLD/u.wav", "./nguyenAmHuanLuyen/09MPD/a.wav", "./nguyenAmHuanLuyen/09MPD/e.wav", "./nguyenAmHuanLuyen/09MPD/i.wav", "./nguyenAmHuanLuyen/09MPD/o.wav", "./nguyenAmHuanLuyen/09MPD/u.wav", "./nguyenAmHuanLuyen/10MSD/a.wav", "./nguyenAmHuanLuyen/10MSD/e.wav", "./nguyenAmHuanLuyen/10MSD/i.wav", "./nguyenAmHuanLuyen/10MSD/o.wav", "./nguyenAmHuanLuyen/10MSD/u.wav", "./nguyenAmHuanLuyen/11MVD/a.wav", "./nguyenAmHuanLuyen/11MVD/e.wav", "./nguyenAmHuanLuyen/11MVD/i.wav", "./nguyenAmHuanLuyen/11MVD/o.wav", "./nguyenAmHuanLuyen/11MVD/u.wav", "./nguyenAmHuanLuyen/12FTD/a.wav", "./nguyenAmHuanLuyen/12FTD/e.wav", "./nguyenAmHuanLuyen/12FTD/i.wav", "./nguyenAmHuanLuyen/12FTD/o.wav", "./nguyenAmHuanLuyen/12FTD/u.wav", "./nguyenAmHuanLuyen/14FHH/a.wav", "./nguyenAmHuanLuyen/14FHH/e.wav", "./nguyenAmHuanLuyen/14FHH/i.wav", "./nguyenAmHuanLuyen/14FHH/o.wav", "./nguyenAmHuanLuyen/14FHH/u.wav", "./nguyenAmHuanLuyen/15MMH/a.wav", "./nguyenAmHuanLuyen/15MMH/e.wav", "./nguyenAmHuanLuyen/15MMH/i.wav", "./nguyenAmHuanLuyen/15MMH/o.wav", "./nguyenAmHuanLuyen/15MMH/u.wav", "./nguyenAmHuanLuyen/16FTH/a.wav", "./nguyenAmHuanLuyen/16FTH/e.wav", "./nguyenAmHuanLuyen/16FTH/i.wav", "./nguyenAmHuanLuyen/16FTH/o.wav", "./nguyenAmHuanLuyen/16FTH/u.wav", "./nguyenAmHuanLuyen/17MTH/a.wav", "./nguyenAmHuanLuyen/17MTH/e.wav", "./nguyenAmHuanLuyen/17MTH/i.wav", "./nguyenAmHuanLuyen/17MTH/o.wav", "./nguyenAmHuanLuyen/17MTH/u.wav", "./nguyenAmHuanLuyen/18MNK/a.wav", "./nguyenAmHuanLuyen/18MNK/e.wav", "./nguyenAmHuanLuyen/18MNK/i.wav", "./nguyenAmHuanLuyen/18MNK/o.wav", "./nguyenAmHuanLuyen/18MNK/u.wav", "./nguyenAmHuanLuyen/19MXK/a.wav", "./nguyenAmHuanLuyen/19MXK/e.wav", "./nguyenAmHuanLuyen/19MXK/i.wav", "./nguyenAmHuanLuyen/19MXK/o.wav", "./nguyenAmHuanLuyen/19MXK/u.wav", "./nguyenAmHuanLuyen/20MVK/a.wav", "./nguyenAmHuanLuyen/20MVK/e.wav", "./nguyenAmHuanLuyen/20MVK/i.wav", "./nguyenAmHuanLuyen/20MVK/o.wav", "./nguyenAmHuanLuyen/20MVK/u.wav", "./nguyenAmHuanLuyen/21MTL/a.wav", "./nguyenAmHuanLuyen/21MTL/e.wav", "./nguyenAmHuanLuyen/21MTL/i.wav", "./nguyenAmHuanLuyen/21MTL/o.wav", "./nguyenAmHuanLuyen/21MTL/u.wav", "./nguyenAmHuanLuyen/22MHL/a.wav", "./nguyenAmHuanLuyen/22MHL/e.wav", "./nguyenAmHuanLuyen/22MHL/i.wav", "./nguyenAmHuanLuyen/22MHL/o.wav", "./nguyenAmHuanLuyen/22MHL/u.wav",
    ];

vowelTest = [
    "./nguyenAmKiemThu/23MTL/a.wav", "./nguyenAmKiemThu/23MTL/e.wav", "./nguyenAmKiemThu/23MTL/i.wav", "./nguyenAmKiemThu/23MTL/o.wav", "./nguyenAmKiemThu/23MTL/u.wav", "./nguyenAmKiemThu/24FTL/a.wav", "./nguyenAmKiemThu/24FTL/e.wav", "./nguyenAmKiemThu/24FTL/i.wav", "./nguyenAmKiemThu/24FTL/o.wav", "./nguyenAmKiemThu/24FTL/u.wav", "./nguyenAmKiemThu/25MLM/a.wav", "./nguyenAmKiemThu/25MLM/e.wav", "./nguyenAmKiemThu/25MLM/i.wav", "./nguyenAmKiemThu/25MLM/o.wav", "./nguyenAmKiemThu/25MLM/u.wav", "./nguyenAmKiemThu/27MCM/a.wav", "./nguyenAmKiemThu/27MCM/e.wav", "./nguyenAmKiemThu/27MCM/i.wav", "./nguyenAmKiemThu/27MCM/o.wav", "./nguyenAmKiemThu/27MCM/u.wav", "./nguyenAmKiemThu/28MVN/a.wav", "./nguyenAmKiemThu/28MVN/e.wav", "./nguyenAmKiemThu/28MVN/i.wav", "./nguyenAmKiemThu/28MVN/o.wav", "./nguyenAmKiemThu/28MVN/u.wav", "./nguyenAmKiemThu/29MHN/a.wav", "./nguyenAmKiemThu/29MHN/e.wav", "./nguyenAmKiemThu/29MHN/i.wav", "./nguyenAmKiemThu/29MHN/o.wav", "./nguyenAmKiemThu/29MHN/u.wav", "./nguyenAmKiemThu/30FTN/a.wav", "./nguyenAmKiemThu/30FTN/e.wav", "./nguyenAmKiemThu/30FTN/i.wav", "./nguyenAmKiemThu/30FTN/o.wav", "./nguyenAmKiemThu/30FTN/u.wav", "./nguyenAmKiemThu/32MTP/a.wav", "./nguyenAmKiemThu/32MTP/e.wav", "./nguyenAmKiemThu/32MTP/i.wav", "./nguyenAmKiemThu/32MTP/o.wav", "./nguyenAmKiemThu/32MTP/u.wav", "./nguyenAmKiemThu/33MHP/a.wav", "./nguyenAmKiemThu/33MHP/e.wav", "./nguyenAmKiemThu/33MHP/i.wav", "./nguyenAmKiemThu/33MHP/o.wav", "./nguyenAmKiemThu/33MHP/u.wav", "./nguyenAmKiemThu/34MQP/a.wav", "./nguyenAmKiemThu/34MQP/e.wav", "./nguyenAmKiemThu/34MQP/i.wav", "./nguyenAmKiemThu/34MQP/o.wav", "./nguyenAmKiemThu/34MQP/u.wav", "./nguyenAmKiemThu/35MMQ/a.wav", "./nguyenAmKiemThu/35MMQ/e.wav", "./nguyenAmKiemThu/35MMQ/i.wav", "./nguyenAmKiemThu/35MMQ/o.wav", "./nguyenAmKiemThu/35MMQ/u.wav", "./nguyenAmKiemThu/36MAQ/a.wav", "./nguyenAmKiemThu/36MAQ/e.wav", "./nguyenAmKiemThu/36MAQ/i.wav", "./nguyenAmKiemThu/36MAQ/o.wav", "./nguyenAmKiemThu/36MAQ/u.wav", "./nguyenAmKiemThu/37MDS/a.wav", "./nguyenAmKiemThu/37MDS/e.wav", "./nguyenAmKiemThu/37MDS/i.wav", "./nguyenAmKiemThu/37MDS/o.wav", "./nguyenAmKiemThu/37MDS/u.wav", "./nguyenAmKiemThu/38MDS/a.wav", "./nguyenAmKiemThu/38MDS/e.wav", "./nguyenAmKiemThu/38MDS/i.wav", "./nguyenAmKiemThu/38MDS/o.wav", "./nguyenAmKiemThu/38MDS/u.wav", "./nguyenAmKiemThu/39MTS/a.wav", "./nguyenAmKiemThu/39MTS/e.wav", "./nguyenAmKiemThu/39MTS/i.wav", "./nguyenAmKiemThu/39MTS/o.wav", "./nguyenAmKiemThu/39MTS/u.wav", "./nguyenAmKiemThu/40MHS/a.wav", "./nguyenAmKiemThu/40MHS/e.wav", "./nguyenAmKiemThu/40MHS/i.wav", "./nguyenAmKiemThu/40MHS/o.wav", "./nguyenAmKiemThu/40MHS/u.wav", "./nguyenAmKiemThu/41MVS/a.wav", "./nguyenAmKiemThu/41MVS/e.wav", "./nguyenAmKiemThu/41MVS/i.wav", "./nguyenAmKiemThu/41MVS/o.wav", "./nguyenAmKiemThu/41MVS/u.wav", "./nguyenAmKiemThu/42FQT/a.wav", "./nguyenAmKiemThu/42FQT/e.wav", "./nguyenAmKiemThu/42FQT/i.wav", "./nguyenAmKiemThu/42FQT/o.wav", "./nguyenAmKiemThu/42FQT/u.wav", "./nguyenAmKiemThu/43MNT/a.wav", "./nguyenAmKiemThu/43MNT/e.wav", "./nguyenAmKiemThu/43MNT/i.wav", "./nguyenAmKiemThu/43MNT/o.wav", "./nguyenAmKiemThu/43MNT/u.wav", "./nguyenAmKiemThu/44MTT/a.wav", "./nguyenAmKiemThu/44MTT/e.wav", "./nguyenAmKiemThu/44MTT/i.wav", "./nguyenAmKiemThu/44MTT/o.wav", "./nguyenAmKiemThu/44MTT/u.wav", "./nguyenAmKiemThu/45MDV/a.wav", "./nguyenAmKiemThu/45MDV/e.wav", "./nguyenAmKiemThu/45MDV/i.wav", "./nguyenAmKiemThu/45MDV/o.wav", "./nguyenAmKiemThu/45MDV/u.wav",
    ];

fileName = [
    "01MDA_a", "01MDA_e", "01MDA_i", "01MDA_o", "01MDA_u", "02FVA_a", "02FVA_e", "02FVA_i", "02FVA_o", "02FVA_u", "03MAB_a", "03MAB_e", "03MAB_i", "03MAB_o", "03MAB_u", "04MHB_a", "04MHB_e", "04MHB_i", "04MHB_o", "04MHB_u", "05MVB_a", "05MVB_e", "05MVB_i", "05MVB_o", "05MVB_u", "06FTB_a", "06FTB_e", "06FTB_i", "06FTB_o", "06FTB_u", "07FTC_a", "07FTC_e", "07FTC_i", "07FTC_o", "07FTC_u", "08MLD_a", "08MLD_e", "08MLD_i", "08MLD_o", "08MLD_u", "09MPD_a", "09MPD_e", "09MPD_i", "09MPD_o", "09MPD_u", "10MSD_a", "10MSD_e", "10MSD_i", "10MSD_o", "10MSD_u", "11MVD_a", "11MVD_e", "11MVD_i", "11MVD_o", "11MVD_u", "12FTD_a", "12FTD_e", "12FTD_i", "12FTD_o", "12FTD_u", "14FHH_a", "14FHH_e", "14FHH_i", "14FHH_o", "14FHH_u", "15MMH_a", "15MMH_e", "15MMH_i", "15MMH_o", "15MMH_u", "16FTH_a", "16FTH_e", "16FTH_i", "16FTH_o", "16FTH_u", "17MTH_a", "17MTH_e", "17MTH_i", "17MTH_o", "17MTH_u", "18MNK_a", "18MNK_e", "18MNK_i", "18MNK_o", "18MNK_u", "19MXK_a", "19MXK_e", "19MXK_i", "19MXK_o", "19MXK_u", "20MVK_a", "20MVK_e", "20MVK_i", "20MVK_o", "20MVK_u", "21MTL_a", "21MTL_e", "21MTL_i", "21MTL_o", "21MTL_u", "22MHL_a", "22MHL_e", "22MHL_i", "22MHL_o", "22MHL_u",
    ];

fileName_Test = [
    "23MTL_a", "23MTL_e", "23MTL_i", "23MTL_o", "23MTL_u", "24FTL_a", "24FTL_e", "24FTL_i", "24FTL_o", "24FTL_u", "25MLM_a", "25MLM_e", "25MLM_i", "25MLM_o", "25MLM_u", "27MCM_a", "27MCM_e", "27MCM_i", "27MCM_o", "27MCM_u", "28MVN_a", "28MVN_e", "28MVN_i", "28MVN_o", "28MVN_u", "29MHN_a", "29MHN_e", "29MHN_i", "29MHN_o", "29MHN_u", "30FTN_a", "30FTN_e", "30FTN_i", "30FTN_o", "30FTN_u", "32MTP_a", "32MTP_e", "32MTP_i", "32MTP_o", "32MTP_u", "33MHP_a", "33MHP_e", "33MHP_i", "33MHP_o", "33MHP_u", "34MQP_a", "34MQP_e", "34MQP_i", "34MQP_o", "34MQP_u", "35MMQ_a", "35MMQ_e", "35MMQ_i", "35MMQ_o", "35MMQ_u", "36MAQ_a", "36MAQ_e", "36MAQ_i", "36MAQ_o", "36MAQ_u", "37MDS_a", "37MDS_e", "37MDS_i", "37MDS_o", "37MDS_u", "38MDS_a", "38MDS_e", "38MDS_i", "38MDS_o", "38MDS_u", "39MTS_a", "39MTS_e", "39MTS_i", "39MTS_o", "39MTS_u", "40MHS_a", "40MHS_e", "40MHS_i", "40MHS_o", "40MHS_u", "41MVS_a", "41MVS_e", "41MVS_i", "41MVS_o", "41MVS_u", "42FQT_a", "42FQT_e", "42FQT_i", "42FQT_o", "42FQT_u", "43MNT_a", "43MNT_e", "43MNT_i", "43MNT_o", "43MNT_u", "44MTT_a", "44MTT_e", "44MTT_i", "44MTT_o", "44MTT_u", "45MDV_a", "45MDV_e", "45MDV_i", "45MDV_o", "45MDV_u",
    ];


k = 5;
coefficient = 13;

% nhận dạng nguyên âm bằng phương phương mfcc


% trích xuất 5xk vector đặc trưng
vectorFeatureAver_a = vectorFeatureAverage(vowelTraining, fileName, 1, k, coefficient);
vectorFeatureAver_e = vectorFeatureAverage(vowelTraining, fileName, 2, k, coefficient);
vectorFeatureAver_i = vectorFeatureAverage(vowelTraining, fileName, 3, k, coefficient);
vectorFeatureAver_o = vectorFeatureAverage(vowelTraining, fileName, 4, k, coefficient);
vectorFeatureAver_u = vectorFeatureAverage(vowelTraining, fileName, 5, k, coefficient);

%figure(1);

%gscatter(vectorFeatureAver_a(1, :), vectorFeatureAver_a(2, :));

numberFileCorrect = 0;

for i = 1:length(vowelTest)
    % trích xuất vector đặc trưng của nguyên âm kiểm thử
    [vectorFeature_Before_Test, vectorFeature_Test] = extractMFCC(vowelTest(i), fileName(i), k, coefficient);
    % tính khoảng cách giữa vector đặc trưng của nguyên âm kiểm thử với
    % 5xk vector trung bình của 5 nguyên âm
    [distance_a, distance_e, distance_i, distance_o, distance_u] = euclideanDistance(k, coefficient, vectorFeature_Before_Test, vectorFeatureAver_a, vectorFeatureAver_e, vectorFeatureAver_i, vectorFeatureAver_o, vectorFeatureAver_u);

    % tìm khoảng cách có giá trị nhỏ nhất trong k vector 
    vectorMin(1) = findMin(distance_a);
    vectorMin(2) = findMin(distance_e);
    vectorMin(3) = findMin(distance_i);
    vectorMin(4) = findMin(distance_o);
    vectorMin(5) = findMin(distance_u);
    
    % nhận dạng nguyên âm
    minValue_final = vectorMin(1);
    indexVowel = 1;
    for j=2:5
        if vectorMin(j) < minValue_final
            minValue_final = vectorMin(j);
            indexVowel = j;
        end
    end

    if indexVowel == 1
        identifyVowel = 'a';
    elseif indexVowel == 2
        identifyVowel = 'e';
    elseif indexVowel == 3
        identifyVowel = 'i';
    elseif indexVowel == 4
        identifyVowel = 'o';
    elseif indexVowel == 5
        identifyVowel = 'u';
    end

    % kiểm tra kết quả nhận dạng với nhãn tên file
    if strfind(fileName_Test(i), identifyVowel)
        numberFileCorrect = numberFileCorrect + 1;
        fprintf("%s duoc nhan dang la nguyen am /%c/ - Đúng\n ", fileName_Test(i), identifyVowel);
    else
        fprintf("%s duoc nhan dang la nguyen am /%c/ - Sai\n ", fileName_Test(i), identifyVowel);
    end
     
end

fprintf("Do chinh xac la %f(%c) \n", numberFileCorrect / 105 * 100, '%');
%}


% test

[vectorFeature_Before, vectorFeature, dftz] = extractMFCC(vowelTraining(92), '01MDA_e', k, coefficient);
vectorFeature;
vectorFeature_Before;
dftz;


% nhận dạng nguyên âm bằng phương pháp fft

%{
% trích xuất 5 vector đặc trưng của 5 nguyên âm
vectorFeatureAver_FFT_a = vectorFeatureAverage_FFT(vowelTraining, fileName, 1, k, coefficient);
vectorFeatureAver_FFT_e = vectorFeatureAverage_FFT(vowelTraining, fileName, 2, k, coefficient);
vectorFeatureAver_FFT_i = vectorFeatureAverage_FFT(vowelTraining, fileName, 3, k, coefficient);
vectorFeatureAver_FFT_o = vectorFeatureAverage_FFT(vowelTraining, fileName, 4, k, coefficient);
vectorFeatureAver_FFT_u = vectorFeatureAverage_FFT(vowelTraining, fileName, 5, k, coefficient);

%vectorFeatureAver_FFT_a;


numberFileCorrect = 0;

for i = 1:length(vowelTest)
    % trích xuất vector đặc trưng của nguyên âm kiểm thử
    [vectorFeature_Before_Test, vectorFeature_Test, dftz_aver] = extractMFCC(vowelTest(i), fileName(i), k, coefficient);
    % tính khoảng cách giữa vector đặc trưng của nguyên âm kiểm thử với
    % 5 vector trung bình của 5 nguyên âm
    [distance_a, distance_e, distance_i, distance_o, distance_u] = euclideanDistance_FFT(512, dftz_aver, vectorFeatureAver_FFT_a, vectorFeatureAver_FFT_e, vectorFeatureAver_FFT_i, vectorFeatureAver_FFT_o, vectorFeatureAver_FFT_u);

    % tìm khoảng cách có giá trị nhỏ nhất trong k vector 
    vectorMin(1) = distance_a;
    vectorMin(2) = distance_e;
    vectorMin(3) = distance_i;
    vectorMin(4) = distance_o;
    vectorMin(5) = distance_u;

    % nhận dạng nguyên âm
    
    minValue_final = vectorMin(1);
    indexVowel = 1;
    for j=2:5
        if vectorMin(j) < minValue_final
            minValue_final = vectorMin(j);
            indexVowel = j;
        end
    end
    
    if indexVowel == 1
        identifyVowel = 'a';
    elseif indexVowel == 2
        identifyVowel = 'e';
    elseif indexVowel == 3
        identifyVowel = 'i';
    elseif indexVowel == 4
        identifyVowel = 'o';
    elseif indexVowel == 5
        identifyVowel = 'u';
    else 
        identifyVowel = "haha";
    end

    % kiểm tra kết quả nhận dạng với nhãn tên file
    if strfind(fileName_Test(i), identifyVowel)
        numberFileCorrect = numberFileCorrect + 1;
        fprintf("%s duoc nhan dang la nguyen am /%c/ - Đúng\n ", fileName_Test(i), identifyVowel);
    else
        fprintf("%s duoc nhan dang la nguyen am /%c/ - Sai\n ", fileName_Test(i), identifyVowel);
    end
     
end
fprintf("So file dung: %d/%s \n", numberFileCorrect, '105');
fprintf("Do chinh xac la %f(%c) \n", numberFileCorrect / 105 * 100, '%');
%}






